---
title: "Lab1"
author: "Sofia Lopez"
date: "2026-02-03"
output: html_document
---

```{r}
knitr::opts_chunk$set(echo = TRUE)

movies <- read.csv("movies_2026.csv")

#Ejercicio 1
summary(movies)
str(movies)
dim(movies)

table(movies$originalLanguage)
table(movies$video)
table(movies$releaseYear)

#Ejercicio 2
tablaTipos <- data.frame(
  Variable = names(movies),
  Tipo = sapply(movies, function(x) {
    if (is.numeric(x)) {
      "Cuantitativa"
    } else {
      "Cualitativa"
    }
  })
)

tablaTipos
tablaTipos <- edit(tablaTipos)
tablaTipos

#Ejercicio 3
hist(movies$budget[!is.na(movies$budget)],
     main = "Presupuesto",
     xlab = "Presupuesto",
     breaks = 30)

hist(movies$revenue[!is.na(movies$revenue)],
     main = "Ingresos",
     xlab = "Ingresos",
     breaks = 30)

hist(movies$runtime[!is.na(movies$runtime)],
     main = "Duracion",
     xlab = "Duracion",
     breaks = 30)

hist(movies$popularity[!is.na(movies$popularity)],
     main = "Popularidad",
     xlab = "Popularidad",
     breaks = 30)

hist(movies$voteAvg[!is.na(movies$voteAvg)],
     main = "Promedio de votos",
     xlab = "Promedio de votos",
     breaks = 30)

hist(movies$voteCount[!is.na(movies$voteCount)],
     main = "Conteo de votos",
     xlab = "Conteo de votos",
     breaks = 30)

hist(movies$genresAmount[!is.na(movies$genresAmount)],
     main = "Cantidad de generos",
     xlab = "Cantidad de generos",
     breaks = 30)

hist(movies$productionCoAmount[!is.na(movies$productionCoAmount)],
     main = "Cantidad de compañias",
     xlab = "Cantidad de compañias",
     breaks = 30)

hist(movies$productionCountriesAmount[!is.na(movies$productionCountriesAmount)],
     main = "Cantidad de paises",
     xlab = "Cantidad de paises",
     breaks = 30)

hist(movies$actorsAmount[!is.na(movies$actorsAmount)],
     main = "Cantidad de actores",
     xlab = "Cantidad de actores",
     breaks = 30)

hist(movies$castWomenAmount,
     main = "Cantidad de mujeres",
     xlab = "Cantidad de mujeres",
     breaks = 30)

hist(movies$castMenAmount,
     main = "Cantidad de hombres",
     xlab = "Cantidad de hombres",
     breaks = 30)


generos_sep <- strsplit(as.character(movies$genres), "\\|")
generos_individuales <- unlist(generos_sep)
freq_generos <- table(generos_individuales)
tabla_generos <- data.frame(
  Genero = names(freq_generos),
  Frecuencia = as.vector(freq_generos)
)

tabla_generos

table(movies$productionCompany)
table(movies$productionCompanyCountry)
table(movies$video)
table(movies$director)

actores_sep <- strsplit(as.character(movies$actors), "\\|")
actores_individuales <- unlist(actores_sep)
freq_actores <- table(actores_individuales)
tabla_actores <- data.frame(
  Actor = names(freq_actores),
  Frecuencia = as.vector(freq_actores)
)

tabla_actores


table(movies$actorsCharacter)
table(movies$title)
table(movies$originalLanguage)
table(movies$releaseDate)






```

#Ejercicio 4
1. ¿Cuáles son las 10 películas que contaron con más presupuesto?
```{r}

head(movies[order(movies$budget, decreasing = TRUE), c("title", "budget")],10)

```

2. ¿Cuáles son las 10 películas que más ingresos tuvieron?

```{r}
head(movies[order(movies$revenue, decreasing = TRUE), c("title", "revenue")],10)


```
3. ¿Cuál es la película que más votos tuvo?

```{r}
head(movies[order(movies$voteCount, decreasing = TRUE), c("title", "voteCount")],1)

```

4. ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?

```{r}
head(movies[order(movies$voteCount, decreasing = FALSE), c("title", "voteCount")],1)

```
5. 
a. ¿Cuántas películas se hicieron en cada año? ¿En qué año se hicieron más películas?

```{r}
tabYear <- table(movies$releaseYear)
tabYear

barplot(tabYear,                    
        main="Peliculas por año",        
        xlab="Años de publicación", 
        ylab="Número de películas"
) 
```
b. ¿En qué año se hicieron más películas?
```{r}
head(tabYear[order(tabYear, decreasing = TRUE)], 1)

```

6. 
a. ¿Cuál es el género principal de las 20 películas más recientes?

```{r}
allGenres <- unlist(strsplit(movies$genres, "\\|"))
top20 <- movies[order(movies$releaseYear, decreasing = TRUE), ][1:20, ]

top20genres <- unlist(strsplit(top20$genres, "\\|"))

tableRecent <- table(top20genres)

barplot(
  tableRecent,
  main = "Géneros de las 20 películas más recientes",
  xlab = "Género",
  ylab = "Frecuencia",
  col = "lightblue",
  las = 2
)
```

b.  ¿Cuál es el género principal que predomina en el conjunto de datos? 

```{r}
genre_all <- table(allGenres)

barplot(
  genre_all,
  main = "Distribución de géneros en todo el dataset",
  xlab = "Género",
  ylab = "Frecuencia",
  col = "lightgreen",
)

names(which.max(genre_all))
```

c. ¿A qué género principal pertenecen las películas más largas?
```{r}
longMovies <- movies[order(movies$runtime, decreasing = TRUE), ][1:20, ]

genresLong <- unlist(strsplit(longMovies$genres, "\\|"))

tableLong <- table(genresLong)
tableLong

barplot(
  tableLong,
  main = "Generos de las peliculas mas largas",
  xlab = "Genero",
  ylab = "Frecuencia",
  col = "pink"
)
```

7. ¿Las películas de qué genero principal obtuvieron mayores ganancias?

```{r}
movies$profit <- movies$revenue - movies$budget

movies_clean <- movies[!is.na(movies$profit) & !is.na(movies$genres), ]

genresRevenue <- strsplit(movies_clean$genres, "\\|")

genres_x <- data.frame(
  genre = unlist(genresRevenue),
  profit = rep(movies_clean$profit, times = sapply(genresRevenue, length))
)

profit_by_genre <- aggregate(profit ~ genre, data = genres_x, sum)


profit_by_genre <- profit_by_genre[
  order(profit_by_genre$profit, decreasing = TRUE),
]

profit_by_genre[1, ]
```

8. 
a. ¿La cantidad de actores influye en los ingresos de las películas?
```{r}
cor(movies$actorsAmount,movies$revenue)

plot(
  movies$actorsAmount,
  movies$revenue,
  xlab = "Cantidad de actores",
  ylab = "Ingresos",
  main = "Relación entre número de actores e ingresos",
  pch = 19,
  col = "purple"
)

abline(
  lm(revenue ~ actorsAmount, data = movies),
  col = "salmon",
  lwd = 2
)
```
b. ¿se han hecho películas con más actores en los últimos años?

```{r}

actors_by_year <- aggregate(
  actorsAmount ~ releaseYear,
  data = movies,
  mean
)

plot(
  actors_by_year$releaseYear,
  actors_by_year$actorsAmount,
  type = "l",
  xlab = "Año",
  ylab = "Promedio de actores",
  main = "Tendencia del número de actores en el tiempo"
)


```

9. ¿Es posible que la cantidad de hombres y mujeres en el reparto influya en la popularidad y los ingresos de las películas?

```{R}
cor(movies$castMenAmount, movies$revenue, use = "complete.obs")
cor(movies$castWomenAmount, movies$revenue, use = "complete.obs")

cor(movies$castMenAmount, movies$popularity, use = "complete.obs")
cor(movies$castWomenAmount, movies$popularity, use = "complete.obs")

plot(
  movies$castWomenAmount,
  movies$revenue,
  xlab = "Cantidad de actrices",
  ylab = "Ingresos",
  main = "Actrices vs Ingresos",
  pch = 19,
  col = "pink"
)
abline(lm(revenue ~ castWomenAmount, data = movies), col = "red")

plot(
  movies$castMenAmount,
  movies$revenue,
  xlab = "Cantidad de actores",
  ylab = "Ingresos",
  main = "Actores vs Ingresos",
  pch = 19,
  col = "blue"
)
abline(lm(revenue ~ castMenAmount, data = movies), col = "gray")


```

10. ¿Quiénes son los directores que hicieron las 20 películas mejor calificadas?

```{r}
top20 <- movies[order(movies$voteCount, decreasing = TRUE),][1:20, ]

top20[, c("director", "title", "voteCount")]

```

11. ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos?
```{r}
cor(movies$budget, movies$revenue)

hist(
  movies$budget,
  main = "Distribución de presupuestos",
  xlab = "Presupuesto",
  col = "lightblue",
  breaks = 30
)

hist(
  movies$revenue,
  main = "Distribución de ingresos",
  xlab = "Ingresos",
  col = "lightgreen",
  breaks = 30
)

plot(
  movies$budget,
  movies$revenue,
  xlab = "Presupuesto",
  ylab = "Ingresos",
  main = "Presupuesto vs Ingresos",
  pch = 19,
  col = "magenta"
)

abline(
  lm(revenue ~ budget, data = movies),
  col = "red",
  lwd = 2
)

```
12. ¿Se asocian ciertos meses de lanzamiento con mejores ingresos?

```{r}
movies$releaseDate <- as.Date(movies$releaseDate)

movies$releaseMonth <- format(movies$releaseDate, "%m")
movies$releaseMonth <- as.numeric(movies$releaseMonth)

moviesN <- movies[
  !is.na(movies$releaseMonth) & !is.na(movies$revenue),
]

revenueMonth <- aggregate(
  revenue ~ releaseMonth,
  data = moviesN,
  mean
)

barplot(
  revenueMonth$revenue,
  names.arg = revenueMonth$releaseMonth,
  main = "Ingresos promedio según mes de lanzamiento",
  xlab = "Mes de lanzamiento",
  ylab = "Ingreso promedio",
  col = "lightblue"
)


```

13. 
a. ¿En qué meses se han visto los lanzamientos con mejores ingresos?
```{r}
revenueMonth <- revenueMonth[
  order(revenueMonth$revenue, decreasing = TRUE),
]

head(revenueMonth, 3)


```

b. ¿cuantas películas, en promedio, se han lanzado por mes?
```{r}
movies$releaseDate <- as.Date(movies$releaseDate)
movies$releaseMonth <- as.numeric(format(movies$releaseDate, "%m"))

movies_clean <- movies[!is.na(movies$releaseMonth), ]

moviesMonth <- table(movies_clean$releaseMonth)
moviesMonth

mean(moviesMonth)


```

14. ¿Cómo se correlacionan las calificaciones con el éxito comercial?
```{r}
cor(movies$voteAvg, movies$revenue)

plot(
  movies$voteAvg,
  movies$revenue,
  xlab = "Calificación",
  ylab = "Ingresos",
  main = "Relación entre calificación y éxito comercial",
  pch = 19,
  col = "purple"
)

abline(
  lm(revenue ~ voteAvg, data = movies),
  col = "red",
  lwd = 2
)

```

15. ¿Qué estrategias de marketing, como videos promocionales o páginas oficiales, generan mejores resultados?

```{r}
table(movies$video)

movies$hasHomepage <- !is.na(movies$homePage) & movies$homePage != ""
table(movies$hasHomepage)

aggregate(
  revenue ~ video,
  data = movies,
  mean
)


boxplot(
  revenue ~ video,
  data = movies,
  main = "Ingresos según presencia de video",
  xlab = "¿Tiene video?",
  ylab = "Ingresos",
  col = c("lightgray", "lightblue")
)

aggregate(
  revenue ~ hasHomepage,
  data = movies,
  mean
)

boxplot(
  revenue ~ hasHomepage,
  data = movies,
  main = "Ingresos según página oficial",
  xlab = "¿Tiene página oficial?",
  ylab = "Ingresos",
  col = c("lightgray", "lightgreen")
)


```
16. ¿La popularidad del elenco está directamente correlacionada con el éxito de taquilla?
```{r}
#se usa popularidad promedio del elenco

meanPopularity <- function(x) {
  nums <- suppressWarnings(as.numeric(strsplit(x, "\\|")[[1]]))
  nums <- nums[!is.na(nums)]
  
  if (length(nums) == 0) {
    return(NA)
  } else {
    return(mean(nums))
  }
}


movies$popularityMean <- sapply(
  movies$actorsPopularity,
  meanPopularity
)



movies_clean <- movies[
  !is.na(movies$popularityMean) & !is.na(movies$revenue),
]


cor(
  movies_clean$popularityMean,
  movies_clean$revenue
)


plot(
  movies_clean$popularityMean,
  movies_clean$revenue,
  xlab = "Popularidad promedio del elenco",
  ylab = "Ingresos",
  main = "Popularidad del elenco vs éxito de taquilla",
  pch = 19,
  col = "lightpink"
)

abline(
  lm(revenue ~ popularityMean, data = movies_clean),
  col = "red",
  lwd = 2
)




```

